extends master.jade
block OrderDefine
    -var active = 0;
    -var pagin_right = true;
    -var reason = "取消原因：";

block title
    title 待发货订单


block DashboardTitle
    待发货订单

block OrderContent
    .headBar
        .btnBar.pull-right
            button(type='button').btn.btn-gray 下载订单信息
            button(type='button').btn.btn-bigblue 上传发货信息
            a.blue 发货信息模板
        input(type='checkbox')#checkAll
        label(for='checkAll') 全选
    .table-responsive.orderlist
        table.table.table-bordered
            tbody
                tr.titleTR
                    td(colspan='2') 
                        | 订单编号: 
                        span.blue 8779641532
                    td.retailer 分销价
                    td.receiver 收货人
                    td 收货地址
                    td 下单时间
                    td 状态
                    td 备注
                    td 操作
                tr.orderTR
                    td.ckTD
                        input(type='checkbox')
                    td.productImgs
                        img(src='../img/logo.png')
                        img(src='../img/logo.png')
                        img(src='../img/logo.png')
                        img(src='../img/logo.png')
                    td ￥387.00
                    td 王刚
                    td 四川省成都市高新区天府软件园E区E1栋
                    td 015-03-12 17:38:48
                    td 等待发货
                    td 客户要求每盒颜色不能重复
                    td.orderOperator
                        a.blue.doExpress 发货
                        a.blue.doNoStock 无货反馈
                        a.blue(href='detail.html') 订单详情
                        a.blue.doCancelOrder 取消订单
                tr.titleTR
                    td(colspan='2') 
                        | 订单编号: 
                        span.blue 8779641532
                    td.retailer 分销价
                    td.receiver 收货人
                    td 收货地址
                    td 下单时间
                    td 状态
                    td 备注
                    td 操作
                tr.orderTR
                    td.ckTD
                        input(type='checkbox')
                    td.productImgs
                        img(src='../img/logo.png')
                        img(src='../img/logo.png')
                    td ￥387.00
                    td 王刚
                    td 四川省成都市高新区天府软件园E区E1栋
                    td 015-03-12 17:38:48
                    td 等待发货
                    td 客户要求每盒颜色不能重复
                    td.orderOperator
                        a.blue.doExpress 发货
                        a.blue.doNoStock 无货反馈
                        a.blue(href='detail.html') 订单详情
                        a.blue.doCancelOrder 取消订单
    .hidden
        form.form-horizontal#expressForm
            .form-group
                label(for='expressCompany').control-label.col-sm-3 快递公司：
                .col-sm-7
                    select.form-control#expressCompany
                        option(value='0') 顺丰
                        option(value='1') 申通
                        option(value='2') 圆通
            .form-group
                label(for='waybill').control-label.col-sm-3 运单号：
                .col-sm-7
                    input(type='text').form-control#inputWaybill
        form.form-horizontal#noStockForm
            .noStockProducts
                div
                    img(src='../img/logo.png').noStockProductImg
                    .ok
                div
                    img(src='../img/logo.png').noStockProductImg
                    .ok
            .form-group
                .col-sm-12
                    label(for='input-noStock').control-label 无货原因：
                .col-sm-12                
                    textarea.form-control#input-noStock
        include returnofgoodsForm.jade
    div.foot
        include ../pagination.jade
block foot
    script(type='text/javascript').
        $(function(){
            $('#checkAll').change(function(){
                var checked = $(this).prop('checked');
                $('.orderlist input[type=checkbox]').prop('checked', checked);
            });
            $(document.body).delegate('.doExpress', 'click', function(e){
                $.dialog({
                    content: $('#expressForm').clone(),
                    title: '填写快递信息',
                    buttons: [
                        {
                            text: '取消',
                            click: function(dialog){ dialog.modal('hide'); }
                        },
                        {
                            text: '确定',
                            style: 'primary',
                            click: function(dialog){
                                //TODO:
                                dialog.modal('hide');
                            }
                        }
                    ]
                });
            });
            $(document.body).delegate('.doNoStock', 'click', function(e){
                $.dialog({
                    content: $('#noStockForm').clone(),
                    title: '无货反馈',
                    buttons: [
                        {
                            text: '取消',
                            click: function(dialog){ dialog.modal('hide'); }
                        },
                        {
                            text: '确定',
                            style: 'primary',
                            click: function(dialog){
                                //TODO:
                                dialog.modal('hide');
                            }
                        }
                    ]
                });
            });
            $(document.body).delegate('.noStockProductImg', 'click', function(e){
                $(e.currentTarget).parent().toggleClass('checked');
            }).delegate('a.removeImg','click', function(e){
                $(e.currentTarget).parent().remove();
            });
            $(document.body).delegate('.doCancelOrder', 'click', function(e){
                $.dialog({
                    content: $('#returnofgoodsForm').clone(),
                    title: '取消订单',
                    buttons: [
                        {
                            text: '取消',
                            click: function(dialog){ dialog.modal('hide'); }
                        },
                        {
                            text: '确定',
                            style: 'primary',
                            click: function(dialog){
                                //TODO:
                                dialog.modal('hide');
                            }
                        }
                    ]
                });
            });

        });

